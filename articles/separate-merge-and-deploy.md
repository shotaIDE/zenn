---
title: "マージとデプロイを独立させる"
emoji: "⛴️"
type: "idea" # tech: 技術記事 / idea: アイデア
topics: ["ios", "android"]
published: false
---

# 前提

トランクベース開発では、短いサイクルでトランクブランチにマージしていきます。
そのため、開発途中のコードもトランクブランチにマージされていくことになります。

こうした状況で、トランクブランチをリリース可能な状態にするには、フィーチャートグルの導入がほぼ必須です。

マージとデプロイの分離が必須です。

その 1 つの手段としてフィーチャートグルがありますが、その他にも手段があります。
本記事では、マージとデプロイの手段としてのフィーチャートグルを導入している前提で解説します。

# 各種機能の取り組む際への難しさ

特定のバージョンからの新機能を案内するための機能を作成する場合、その機能は特定のバージョンからのみ利用可能である必要があります。

その機能をフィーチャートグルで実現する場合、より複雑なロジックが必要です。

最終的には以下のようなロジックが必要になります。

- 「機能を含まない旧アプリ」から「機能を含む新アプリ」への上書きアップデート
- 「機能を含む新アプリ」の新規インストール
- 「機能を含む新アプリ」から「機能を含む新アプリの未来バージョン」への上書きアップデート

一方でフィーチャートグルの分岐がある最中は、以下のパターンで試す必要があります。

- フィーチャートグル OFF から ON に変更した
- フィーチャートグル OFF の場合
